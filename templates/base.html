<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Food App{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <meta name="theme-color" content="#f44336">
  <meta name="apple-mobile-web-app-capable" content="yes">
  {% block head %}{% endblock %}

<style>
body {
  background: #f5f6fa;
  min-height: 100vh;
}

/* Card styling */
.card, .card-header, .card-body {
  border-radius: 17px !important;
  overflow: visible !important;
}
.card-header {
  background: #f8f9fa;
  border-bottom: none;
}
.card .fw-bold { letter-spacing: 0.5px; }
.card-body { padding: 1.1em 1.2em; }
@media (max-width: 600px) {
  .card, .card-header, .card-body {
    border-radius: 13px !important;
  }
  .card-body { padding: 0.9em 1em !important; }
  .card-header { font-size: 1.2em; padding: 5px 4px !important; }
}

/* Special cases for recipe card and drag handle */
.recipe-card { transition: box-shadow 0.2s; }
.recipe-card:active { box-shadow: 0 0 0 2px #ffdae0; }
.drag-handle {
  color: #888; font-size: 15px !important; cursor: grab; user-select: none; transition: color 0.2s;
}
.recipe-card:active .drag-handle, .recipe-card:focus .drag-handle { color: #888; }
.highlight-swap { border: 2px dashed #007bff; background: #eaf3ff; }

.favorite-btn { margin-left: 10px; }

.autocomplete-list {
  background: #fff;
  border: 1px solid #ccc;
  position: absolute !important;
  z-index: 1200 !important;
  width: 220px;
  max-height: 200px;
  overflow-y: auto;
}
.autocomplete-option:hover { background: #f0f0f0; }

/* Choices.js dropdown above modals */
.modal, .modal-body { overflow: visible !important; }
.choices__list--dropdown { z-index: 2055 !important; }

/* Centered modal titles */
.modal-header { justify-content: center !important; }
.modal-title { width: 100%; text-align: center; }

/* Responsive containers and tables */
.container, .main-welcome-container { padding-bottom: 70px; padding-top: 1rem; }
@media (max-width: 600px) {
  .container, .main-welcome-container {
    padding-left: 0.2rem; padding-right: 0.2rem; padding-bottom: 85px !important;
  }
}
.table-responsive { overflow-x: auto; -webkit-overflow-scrolling: touch; }

/* Responsive forms/inputs/buttons */
@media (max-width: 576px) {
  input[type="text"], input[type="number"], select, textarea, .choices__inner, .form-control {
    min-width: 0 !important; width: auto; font-size: 1.02em;
  }
  .autocomplete-input, #autocomplete-input {
    width: 100% !important; min-width: 0 !important; max-width: 100% !important;
  }
  .btn, .btn-sm, .btn-group .btn, .modal-footer .btn {
    width: auto; min-width: 0 !important; margin-top: 1px; margin-bottom: 1px;
    font-size: 0.8em; padding: .2rem .4rem; box-sizing: border-box;
  }
  .btn-inline, .btn-inline.btn, .btn-inline.btn-sm {
    width: auto !important; margin-bottom: 0 !important; display: inline-block !important;
    font-size: 0.65em !important; padding: 0.2rem 0.4rem !important;
  }
  .btn-group { flex-direction: column !important; align-items: stretch !important; gap: 0 !important; }
  .modal-dialog { margin: 1.5rem auto; max-width: 98vw; }
  .form-check, .input-group { flex-direction: column; align-items: stretch; }
  .navbar.fixed-bottom .nav-link { font-size: 1.01em; padding: 0.4rem 0 0.2rem 0; }
  .navbar.fixed-bottom .fa { font-size: 1.35em; }
}

/* Mobile-friendly modals */
@media (max-width: 600px) {
  .modal-dialog { max-width: 380px !important; margin: 0.5rem auto; position: relative; }
  .modal-content {
    display: flow; border-radius: 2rem; padding: 0.5em 0.5em 0.4em 0.5em;
    overflow-y: auto; max-height: 90vh; align-items: center;
  }
  .modal-title { font-size: 1.1rem !important; }
  .modal-body { flex: 1 1 auto; overflow-y: auto; }
  .modal-footer {
    position: sticky; bottom: 0; background: inherit; z-index: 2;
    box-shadow: 0 -2px 8px -4px #0002;
  }
  .modal-content .alert { display: block; font-size: small; padding: 2px; text-align: center; }
  .modal-content label, .modal-content .form-control, .modal-content .form-select, .modal-content .btn {
    font-size: 0.85em !important;
  }
}

/* Offcanvas styling */
.offcanvas {
  width: 300px !important; max-width: 94vw !important; min-width: 200px !important; border-radius: 16px 0 0 16px !important;
}
@media (max-width: 600px) {
  .offcanvas {
    width: 50vw !important; max-width: 50vw !important; min-width: 0 !important;
    border-radius: 10px !important; max-height: 100vw !important;
    left: auto !important; right: auto !important; margin-top: 15px; margin-bottom: 15px;
  }
}

/* Για fading alert */
.goalerror-alert.fade { transition: opacity 1s linear; }
</style>


</head>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">



<body>
  <div class="container{% if request.endpoint == 'welcome' %} main-welcome-container{% endif %}">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="alert alert-warning mt-2 mb-2">
          {% for message in messages %}
            <div>{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </div>

{% if request.endpoint not in ['login', 'signup'] and session.get('user_id') %}
<!-- Side Menu Button -->
<button class="btn btn-outline-secondary position-fixed top-0 start-0 m-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sideMenu" aria-controls="sideMenu">
  <i class="fa fa-bars"></i>
</button>

<!-- Side Slide Offcanvas -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="sideMenu" aria-labelledby="sideMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="sideMenuLabel">🍽 Family Food</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Κλείσιμο"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="list-group">
      <li class="list-group-item"><a href="/welcome" class="text-decoration-none">🏠 Αρχική</a></li>
      <li class="list-group-item"><a href="/menu" class="text-decoration-none">📅 Εβδομαδιαίο Μενού</a></li>
      <li class="list-group-item"><a href="/history" class="text-decoration-none">📜 Ιστορικό</a></li>
      <li class="list-group-item"><a href="/favorites" class="text-decoration-none">⭐ Αγαπημένα</a></li>
      <li class="list-group-item"><a href="/profile" class="text-decoration-none">👤 Προφίλ</a></li>
      <li class="list-group-item">
        <a href="/logout" class="text-danger text-decoration-none" onclick="return confirmLogout();">🚪 Έξοδος</a>
      </li>
    </ul>
  </div>
</div>
{% endif %}

 
<!-- Bottom nav -->
{% if request.endpoint not in ['login', 'signup'] and session.get('user_id') %}  
  <nav class="navbar fixed-bottom navbar-light bg-light shadow-sm" style="z-index:999;">
    <div class="container-fluid justify-content-center p-0">
		<div class="row w-100 text-center">
		  <div class="col-2">
			<a href="/welcome" class="nav-link py-2{% if request.endpoint=='welcome' %} active{% endif %}">
			  <i class="fa fa-home fa-lg"></i><div style="font-size:12px;">Αρχική</div>
			</a>
		  </div>
		  <div class="col-2">
			<a href="/menu" class="nav-link py-2{% if request.endpoint=='menu' %} active{% endif %}">
			  <i class="fa fa-calendar-week fa-lg"></i><div style="font-size:12px;">Μενού</div>
			</a>
		  </div>
		  <div class="col-2">
			<a href="/history" class="nav-link py-2{% if request.endpoint=='history' %} active{% endif %}">
			  <i class="fa fa-history fa-lg"></i><div style="font-size:12px;">Ιστορικό</div>
			</a>
		  </div>
		  <div class="col-2">
			<a href="/favorites" class="nav-link py-2{% if request.endpoint=='favorites' %} active{% endif %}">
			  <i class="fa fa-star fa-lg"></i><div style="font-size:12px;">Αγαπημένα</div>
			</a>
		  </div>
		  <div class="col-2">
			<a href="/profile" class="nav-link py-2{% if request.endpoint=='profile' %} active{% endif %}">
			  <i class="fa fa-user fa-lg"></i><div style="font-size:12px;">Προφίλ</div>
			</a>
		  </div>
		  <div class="col-2">
			<a href="/logout" class="nav-link py-2 text-danger">
			  <i class="fa fa-sign-out-alt fa-lg"></i><div onclick="return confirmLogout();" style="font-size:12px;">Έξοδος</div>
			</a>
		  </div>
		</div>

    </div>
  </nav>
{% endif %}



<!--
{% if session.user_id %}
  <div class="nav-item"><a href="/logout"><i class="fas fa-sign-out-alt"></i> Έξοδος</a></div>
{% endif %}
-->

  {% block modals %}{% endblock %} 

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/plugins/Swap/Sortable.swap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
  
   
   
   
  
  
  
  <script>
	if ('serviceWorker' in navigator) {
	  navigator.serviceWorker.register('/static/service-worker.js')
		.then(function() { console.log('Service Worker Registered'); });
	}
	
	function confirmLogout() {
	  return confirm("Θέλεις σίγουρα να αποσυνδεθείς;");
	}
	
  </script>

  {% block scripts %}{% endblock %}

</body>
</html>
