<!DOCTYPE html>
<html lang="el">
<head>

<title>{% block title %}FamilyFood{% endblock %}</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Indie+Flower&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:700,400|Quicksand:500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <meta name="theme-color" content="#4CAF50">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="theme-color" content="#f44336">
  <meta name="mobile-web-app-capable" content="yes">

<link rel="stylesheet" href="/static/styles.css">
  
{% block head %}{% endblock %}

</head>

<body>

  <div class="container{% if request.endpoint == 'welcome' %} main-welcome-container{% endif %}">
    {% block content %}{% endblock %}
  </div>

<!-- Show recipe modal -->
<div class="modal fade" id="recipeModal" tabindex="-1" aria-labelledby="recipeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header bg-primary">
        <h5 class="modal-title" id="recipeModalLabel">Î›ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚ Î£Ï…Î½Ï„Î±Î³Î®Ï‚</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" style="background:#fefefe; max-height:75vh;">
        <p><strong>Î¤Î¯Ï„Î»Î¿Ï‚:</strong> <span id="modalTitle"></span></p>
        <p><strong>Î£ÎµÏ†:</strong> <span id="modalChef"></span></p>
        <p><strong>Î§ÏÏŒÎ½Î¿Ï‚:</strong>
          <span id="modalPrepTime"></span>â€² Ï€ÏÎ¿ÎµÏ„Î¿Î¹Î¼Î±ÏƒÎ¯Î±,
          <span id="modalCookTime"></span>â€² Î¼Î±Î³ÎµÎ¯ÏÎµÎ¼Î±
        </p>
        <p><strong>ÎœÎ­Î¸Î¿Î´Î¿Ï‚:</strong> <span id="modalMethod"></span></p>
        <p><strong>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±:</strong> <span id="modalCategory"></span></p>
        <p><strong>Tags:</strong> <span id="modalTags"></span></p>
        <p><strong>Î£ÏÎ½Î´ÎµÏƒÎ¼Î¿Ï‚:</strong> <a href="#" id="modalUrl" target="_blank">Î”ÎµÏ‚ Ï„Î· ÏƒÏ…Î½Ï„Î±Î³Î®</a></p>

        <hr>
        <p><strong>Î¥Î»Î¹ÎºÎ¬:</strong></p>
        <form id="modalIngredientsForm">
		  <ul id="modalIngredients" style="padding-left: 20px; list-style: none;"></ul>
		</form>
        <p class="mt-3"><strong>ÎŸÎ´Î·Î³Î¯ÎµÏ‚:</strong></p>
        <div id="modalInstructions" style="white-space: pre-wrap; word-break: break-word;"></div>
      </div>
    </div>
  </div>
</div>


{% if request.endpoint not in ['login', 'signup'] and session.get('user_id') %}
<!-- Side Menu Button -->
<button class="btn btn-outline-secondary position-fixed top-0 start-0 m-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sideMenu" aria-controls="sideMenu">
  <i class="fa fa-bars"></i>
</button>

<!-- Side Slide Offcanvas -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="sideMenu" aria-labelledby="sideMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="sideMenuLabel">ğŸ½ Family Food</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="list-group">
      <li class="list-group-item"><a href="/welcome" class="text-decoration-none">ğŸ  Î‘ÏÏ‡Î¹ÎºÎ®</a></li>
      <li class="list-group-item"><a href="/menu" class="text-decoration-none">ğŸ“… Î•Î²Î´Î¿Î¼Î±Î´Î¹Î±Î¯Î¿ ÎœÎµÎ½Î¿Ï</a></li>
	  <li class="list-group-item"><a href="/ingredients" class="text-decoration-none">ğŸ“œ Î¥Î»Î¹ÎºÎ¬</a></li>
      <li class="list-group-item"><a href="/history" class="text-decoration-none">ğŸ•˜ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ</a></li>
      <li class="list-group-item"><a href="/favorites" class="text-decoration-none">â­ Î‘Î³Î±Ï€Î·Î¼Î­Î½Î±</a></li>
      <li class="list-group-item"><a href="/profile" class="text-decoration-none">ğŸ§‘ Î ÏÎ¿Ï†Î¯Î»</a></li>
	  <li class="list-group-item"><a href="/settings" class="text-decoration-none">âš™ï¸ Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î•Ï†Î±ÏÎ¼Î¿Î³Î®Ï‚</a></li>
      <li class="list-group-item"><a href="/logout" class="text-danger text-decoration-none" onclick="return confirmLogout();">ğŸšª ÎˆÎ¾Î¿Î´Î¿Ï‚</a></li>
	  <li class="list-group-item"><a href="#" class="text-danger text-decoration-none" onclick="showDeleteUserModal(); return false;">ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ±Ï†Î® Î§ÏÎ®ÏƒÏ„Î·</a></li>
    </ul>
  </div>
</div>
{% endif %}

 
<!-- Bottom nav -->
{% if request.endpoint not in ['login', 'signup'] and session.get('user_id') %}  
  <nav class="navbar fixed-bottom navbar-light bg-light shadow-sm" style="z-index:999;">
    <div class="container-fluid justify-content-center p-0">
		<div class="row w-100 text-center">
		  <div class="col">
			<a href="/welcome" class="nav-link py-2{% if request.endpoint=='welcome' %} active{% endif %}">
			  <i class="fa fa-home fa-lg"></i><div style="font-size:12px;">Î‘ÏÏ‡Î¹ÎºÎ®</div>
			</a>
		  </div>
		  <div class="col">
			<a href="/menu" id = "menu-btn" class="nav-link py-2{% if request.endpoint=='menu' %} active{% endif %}">
			  <i class="fa fa-calendar-week fa-lg"></i><div style="font-size:12px;">ÎœÎµÎ½Î¿Ï</div>
			</a>
		  </div>
		  <div class="col">
			<a href="/history" class="nav-link py-2{% if request.endpoint=='history' %} active{% endif %}">
			  <i class="fa fa-history fa-lg"></i><div style="font-size:12px;">Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ</div>
			</a>
		  </div>
		  <div class="col">
			<a href="/favorites" class="nav-link py-2{% if request.endpoint=='favorites' %} active{% endif %}">
			  <i class="fa fa-star fa-lg"></i><div style="font-size:12px;">Î‘Î³Î±Ï€Î·Î¼Î­Î½Î±</div>
			</a>
		  </div>
		  <div class="col">
			<a href="/profile" class="nav-link py-2{% if request.endpoint=='profile' %} active{% endif %}">
			  <i class="fa fa-user fa-lg"></i><div style="font-size:12px;">Î ÏÎ¿Ï†Î¯Î»</div>
			</a>
		  </div>
		</div>

    </div>
  </nav>
{% endif %}


<!--
{% if session.user_id %}
  <div class="nav-item"><a href="/logout"><i class="fas fa-sign-out-alt"></i> ÎˆÎ¾Î¿Î´Î¿Ï‚</a></div>
{% endif %}
-->



  <div class="modal fade" id="deleteUserModal" tabindex="-1" aria-labelledby="deleteUserModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="border-radius: 14px;">
      <div class="modal-header bg-danger-subtle">
        <h5 class="modal-title" id="deleteUserModalLabel">
          <i class="fa fa-user-times text-danger me-2"></i> ÎŸÏÎ¹ÏƒÏ„Î¹ÎºÎ® Î”Î¹Î±Î³ÏÎ±Ï†Î® Î›Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿Ï
        </h5>
      </div>
      <div class="modal-body text-center" style="font-size:1.1em;">
        <p>Î˜Î­Î»ÎµÎ¹Ï‚ ÏƒÎ¯Î³Î¿Ï…ÏÎ± Î½Î± <b>Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬ Ï„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ ÏƒÎ¿Ï…</b> ÎºÎ±Î¹ ÏŒÎ»Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎ¿Ï…;</p>
        <p class="text-danger">Î‘Ï…Ï„Î® Î· ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±Î¹ÏÎµÎ¸ÎµÎ¯!</p>
      </div>
      <div class="modal-footer d-flex flex-column gap-2">
        <button type="button" class="btn btn-danger btn-lg w-100" id="delete-user-confirm-btn">ÎÎ±Î¹, Î´Î¹Î±Î³ÏÎ±Ï†Î®</button>
        <button type="button" class="btn btn-secondary btn-lg w-100" data-bs-dismiss="modal">Î†ÎºÏ…ÏÎ¿</button>
      </div>
    </div>
  </div>
</div>


{% block modals %}{% endblock %} 

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>



<script>

function removeTonos(str) {
  if (!str) return "";
  return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
}

let lastIngredients = [];

function showDeleteUserModal() {
  var modal = new bootstrap.Modal(document.getElementById('deleteUserModal'));
  modal.show();

  document.getElementById('delete-user-confirm-btn').onclick = function() {
    fetch('/delete_user_and_data', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'}
    })
    .then(r => r.json())
    .then(data => {
      if (data.success) {
        window.location.href = '/login';
      } else {
        alert('Î£Ï†Î¬Î»Î¼Î±: ' + (data.error || 'Î”ÎµÎ½ Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ Î· Î´Î¹Î±Î³ÏÎ±Ï†Î®.'));
      }
    });
  };
}
	
function confirmLogout() {
	  return confirm("Î˜Î­Î»ÎµÎ¹Ï‚ ÏƒÎ¯Î³Î¿Ï…ÏÎ± Î½Î± Î±Ï€Î¿ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯Ï‚;");
}
	
function openRecipeModal(card) {
  if (card.classList.contains('no-click')) return;

  const modal = new bootstrap.Modal(document.getElementById('recipeModal'));
  document.getElementById('modalTitle').innerText = card.getAttribute('data-title') || '-';
  document.getElementById('modalChef').innerText = card.getAttribute('data-chef') || '-';
  document.getElementById('modalMethod').innerText = card.getAttribute('data-method') || '-';
  document.getElementById('modalCategory').innerText = card.getAttribute('data-category') || '-';
  document.getElementById('modalTags').innerText = card.getAttribute('data-tags') || '-';
  document.getElementById('modalUrl').href = card.getAttribute('data-url') || '#';
  document.getElementById('modalPrepTime').innerText = card.getAttribute('data-prep') || '-';
  document.getElementById('modalCookTime').innerText = card.getAttribute('data-cook') || '-';

  // Î¥Î»Î¹ÎºÎ¬ Î¼Îµ checkbox
  const ingStr = card.getAttribute('data-ingredients') || '';
  lastIngredients = [];
  var ingredients = ingStr.split(',');
  var ingList = document.getElementById('modalIngredients');
  ingList.innerHTML = '';
  for (var idx = 0; idx < ingredients.length; idx++) {
    var item = ingredients[idx].trim();
    if (!item) continue;
    lastIngredients.push(item);
    var li = document.createElement('li');
    li.style.marginBottom = "2px";

    var checkbox = document.createElement('input');
    checkbox.type = "checkbox";
    checkbox.id = "ing" + idx;
    checkbox.checked = true;

    var label = document.createElement('label');
    label.htmlFor = "ing" + idx;
    label.style.marginLeft = "6px";
    label.style.cursor = "pointer";
    label.appendChild(document.createTextNode(item));

    li.appendChild(checkbox);
    li.appendChild(label);
    ingList.appendChild(li);
  }

  // ÎŸÎ´Î·Î³Î¯ÎµÏ‚
  var instructions = card.getAttribute('data-instructions') || '';
  document.getElementById('modalInstructions').innerText = instructions.trim();

  // Listener Î³Î¹Î± ÎºÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿ modal
  var modalEl = document.getElementById('recipeModal');
  modalEl.removeEventListener('hidden.bs.modal', handleIngredientsClose);
  modalEl.addEventListener('hidden.bs.modal', handleIngredientsClose);

  modal.show();
  
	  // â¤ Î‘Î½ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ onboarding ÎºÎ±Î¹ Î´ÎµÎ½ Ï„Î¿ Î­Ï‡ÎµÎ¹ Î´ÎµÎ¹
	if (!hasSeenRecipeModalTooltip()) {
	  setTimeout(() => {
		showRecipeModalTooltip();
	  }, 300);  // Î»Î¯Î³Î¿ delay Î³Î¹Î± Î½Î± Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯
	}
    
}

function hasSeenRecipeModalTooltip() {
  return localStorage.getItem('menu_onboarding_seen_modal') === '1';
}

function setSeenRecipeModalTooltip() {
  localStorage.setItem('menu_onboarding_seen_modal', '1');
}

function showRecipeModalTooltip() {
  const anchor = document.getElementById('modalIngredientsForm');
  if (!anchor) return;

  const tip = document.createElement('div');
  tip.className = 'recipeModaltip';

  tip.innerHTML =
    '<div>' +
    'Î‘Î½ ÏƒÎ¿Ï… Î»ÎµÎ¯Ï€ÎµÎ¹ ÏƒÎ®Î¼ÎµÏÎ± ÎºÎ¬Ï€Î¿Î¹Î¿ Ï…Î»Î¹ÎºÏŒ Î¾Îµ-Ï„ÏƒÎ­ÎºÎ±ÏÎ­ Ï„Î¿, Î¸Î± Ï„Î¿ Î»Î¬Î²Ï‰ Ï…Ï€ÏŒÏˆÎ¹Î½ Î¼Î¿Ï…!!' +
    '<br>' +
    '<button class="btn btn-primary btn-sm mt-2" id="close-recipe-modal-tooltip">ÎšÎ±Ï„Î¬Î»Î±Î²Î±!</button>' +
    '</div>';

	const arrow = document.createElement('div');
	arrow.className = 'recipeModalarrow';
	arrow.style.top = '65px';  // Ï„Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· Ï€Î¬Î½Ï‰ Î±Ï€ÏŒ Ï„Î¿ tooltip (Î¬ÏÎ± "Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰")
	arrow.style.left = '-10px';  // Î¸Î± Ï„Î¿ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î· Î¸Î­ÏƒÎ· Ï„Î¿Ï… anchor
	tip.appendChild(arrow);

  // Î¥Ï€Î¿Î»ÏŒÎ³Î¹ÏƒÎµ Î¸Î­ÏƒÎ· anchor
  const rect = anchor.getBoundingClientRect();
  const scrollTop = window.scrollY;
  const scrollLeft = window.scrollX;

  // Î˜Î­ÏƒÎ· Ï€Î¬Î½Ï‰ Î±Ï€ÏŒ Ï„Î¿ anchor
  tip.style.top = (scrollTop + rect.top - 30) + 'px';  // 70px Ï€Î¹Î¿ Ï€Î¬Î½Ï‰ Î±Ï€ÏŒ Ï„Î¿ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿
  tip.style.left = (scrollLeft + rect.left + rect.width / 2) + 'px'; // ÎºÎ­Î½Ï„ÏÎ¿ - half width

  document.body.appendChild(tip);
}

function handleIngredientsClose() {
  if (!lastIngredients.length) return;
  var missing = [];
  for (var idx = 0; idx < lastIngredients.length; idx++) {
    var cb = document.getElementById('ing' + idx);
    if (cb && !cb.checked) missing.push(lastIngredients[idx]);
  }
  fetch('/save_missing_ingredients', {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({missing: missing})
  }).then(function(r){return r.json();}).then(function(data){
    if(missing.length) {
      showAlert('Î‘Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ! Î“Î¹Î± ÏƒÎ®Î¼ÎµÏÎ± ÏƒÎ¿Ï… Î»ÎµÎ¯Ï€Î¿Ï…Î½ Ï„Î± Ï…Î»Î¹ÎºÎ¬: ' + missing.join(', '),'success',3000,'center');
    }
  });
}

document.addEventListener('click', function(e) {
  const input = e.target.closest('.voice-enabled');
  if (!input) return;

  // ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ Ï„Î¿ click Î®Ï„Î±Î½ Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿ ğŸ¤ (Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± 36px Î´ÎµÎ¾Î¹Î¬)
  const clickX = e.clientX - input.getBoundingClientRect().left;
  const inputWidth = input.offsetWidth;
  if (clickX >= inputWidth - 36) {
    const menuid = input.dataset.menuid;
    startSpeechForRecipe(menuid);
  }
});

document.addEventListener('click', function(e) {
  if (e.target && e.target.id === 'close-recipe-modal-tooltip') {
    const tip = e.target.closest('.recipeModaltip');
    if (tip) tip.remove();
    setSeenRecipeModalTooltip();
  }
});

/**
 * Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Bootstrap alert (ÏƒÎ±Î½ banner) Î¿Ï€Î¿Ï…Î´Î®Ï€Î¿Ï„Îµ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î±, Î³Î¹Î± 3''.
 *
 * @param {string} message - Î¤Î¿ Î¼Î®Î½Ï…Î¼Î± Ï€Î¿Ï… Î¸ÎµÏ‚ Î½Î± Î´ÎµÎ¯Î¾ÎµÎ¹Ï‚.
 * @param {string} [type='warning'] - Î¤Î¿ ÎµÎ¯Î´Î¿Ï‚ Ï„Î¿Ï… alert (success, danger, info, warning).
 * @param {number} [duration=3000] - Î ÏŒÏƒÎ± ms Î½Î± Î¼ÎµÎ¯Î½ÎµÎ¹ Î¿ÏÎ±Ï„ÏŒ Ï„Î¿ alert.
 * @param {string} [position='top'] - Î Î¿Ï… Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ('top', 'center').
 */
function showAlert(message, type, duration, position) {
  type = type || 'warning';
  duration = duration || 3000;
  position = position || 'top';

  // Î‘Ï†Î±Î¯ÏÎµÏƒÎµ Ï„Ï…Ï‡ÏŒÎ½ Î¬Î»Î»Î± alerts Î³Î¹Î± Î½Î± Î¼Î· ÏƒÏ‰ÏÎµÏÎ¿Î½Ï„Î±Î¹.
  var existing = document.querySelectorAll('.custom-js-alert');
  for (var i = 0; i < existing.length; i++) {
    existing[i].parentNode.removeChild(existing[i]);
  }

  var alertDiv = document.createElement('div');
  alertDiv.className = 'alert alert-' + type + ' alert-dismissible fade show custom-js-alert';
  alertDiv.role = 'alert';
  alertDiv.style.position = 'fixed';
  alertDiv.style.zIndex = 3000;
  alertDiv.style.left = '50%';
  alertDiv.style.maxWidth = '400px';
  alertDiv.style.width = '90vw';
  alertDiv.style.boxShadow = '0 4px 24px rgba(0,0,0,0.15)';
  alertDiv.style.textAlign = 'center';
  alertDiv.style.opacity = '1';

  if (position === 'top') {
    alertDiv.style.top = '32px';
    alertDiv.style.transform = 'translateX(-50%)';
  } else if (position === 'center') {
    alertDiv.style.top = '50%';
    alertDiv.style.transform = 'translate(-50%, -60%)';
  }

  alertDiv.innerHTML =
    message +
    '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>';

  document.body.appendChild(alertDiv);

  setTimeout(function() {
    alertDiv.style.opacity = '0';
    setTimeout(function() {
      if (alertDiv.parentNode) {
        alertDiv.parentNode.removeChild(alertDiv);
      }
    }, 600);
  }, duration);
}

document.addEventListener('DOMContentLoaded', function() {
  const recipeModalEl = document.getElementById('recipeModal');
  if (recipeModalEl) {
    recipeModalEl.addEventListener('hidden.bs.modal', function () {
      // Î‘Ï†Î±Î¯ÏÎµÏƒÎ· Ï„Î¿Ï… tooltip Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹
      const tip = document.querySelector('.recipeModaltip');
      if (tip) tip.remove();
    });
  }
});

</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  let touchStartX = 0;
  let touchEndX = 0;

  document.addEventListener('touchstart', function (e) {
    touchStartX = e.changedTouches[0].screenX;
  });

  document.addEventListener('touchend', function (e) {
    touchEndX = e.changedTouches[0].screenX;
    handleGesture();
  });

  function handleGesture() {
    const distance = touchEndX - touchStartX;

    // Î‘Î½ Î­Î³Î¹Î½Îµ swipe Î±Ï€ÏŒ Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬ Ï€ÏÎ¿Ï‚ Ï„Î± Î´ÎµÎ¾Î¹Î¬ Î¼Îµ Ï€Î¬Î½Ï‰ Î±Ï€ÏŒ 50px Î±Ï€ÏŒÏƒÏ„Î±ÏƒÎ·
    if (touchStartX < 40 && distance > 50) {
      const offcanvas = new bootstrap.Offcanvas(document.getElementById('sideMenu'));
      offcanvas.show();
    }
	
	
	if (touchStartX > window.innerWidth - 80 && distance < -50) {
	  const offcanvasEl = document.getElementById('sideMenu');
	  const offcanvas = bootstrap.Offcanvas.getInstance(offcanvasEl);
	  if (offcanvas) offcanvas.hide();
	}
  }
});
</script>


{% block scripts %}{% endblock %}


<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register("{{ url_for('static', filename='service-worker.js') }}")
      .then(function(reg) {
        console.log("Service Worker registered: ", reg.scope);
      })
      .catch(function(error) {
        console.error("Service Worker registration failed:", error);
      });
  }
</script>

</body>

</html>
